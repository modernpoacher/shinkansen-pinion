"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderToRadiosForEnum=renderToRadiosForEnum;exports.renderToRadiosForAnyOf=renderToRadiosForAnyOf;exports.renderToRadiosForOneOf=renderToRadiosForOneOf;exports.renderToSelectForEnum=renderToSelectForEnum;exports.renderToSelectForAnyOf=renderToSelectForAnyOf;exports.renderToSelectForOneOf=renderToSelectForOneOf;exports.renderToField=renderToField;exports.GroupComponent=GroupComponent;exports.FieldComponent=FieldComponent;exports.Group=Group;exports.Field=Field;exports.renderGroup=renderGroup;exports.renderField=renderField;exports.default=Pinion;var _react=_interopRequireDefault(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _debug=_interopRequireDefault(require("debug"));var _shinkansenSprockets=require("shinkansen-sprockets");var _shinkansenCogs=require("shinkansen-cogs");var _hasEnum=_interopRequireDefault(require("../../transformers/common/has-enum"));var _hasAnyOf=_interopRequireDefault(require("../../transformers/common/has-any-of"));var _hasOneOf=_interopRequireDefault(require("../../transformers/common/has-one-of"));var _hasComponent=_interopRequireDefault(require("../../transformers/common/has-component"));var _getComponent=_interopRequireDefault(require("../../transformers/common/get-component"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}var log=(0,_debug.default)('shinkansen:pinion');log('`pinion` is awake');function onChange(){}var getKey=function getKey(value,index){return"".concat(value,"-").concat(index);};var getDefaultValue=function getDefaultValue(field){return Reflect.has(field,'defaultValue')?Reflect.get(field,'defaultValue'):'';};var getValue=function getValue(field){return Reflect.has(field,'value')?Reflect.get(field,'value'):getDefaultValue(field);};function renderToRadiosForEnum(_ref,_ref2,_ref3,onChange){var _ref$items=_ref.items,items=_ref$items===void 0?[]:_ref$items,_ref$selectedItems=_ref.selectedItems,selectedItems=_ref$selectedItems===void 0?[]:_ref$selectedItems,uri=_ref.uri;var title=_ref2.title,description=_ref2.description,_ref2$enum=_ref2.enum,id=_ref2$enum.id,_ref2$enum$name=_ref2$enum.name,name=_ref2$enum$name===void 0?id:_ref2$enum$name,_ref2$enum$isRequired=_ref2$enum.isRequired,isRequired=_ref2$enum$isRequired===void 0?false:_ref2$enum$isRequired;var components=_ref3.components,errors=_ref3.errors;log('renderToRadiosForEnum');return _react.default.createElement(_shinkansenSprockets.FieldsetSprocket,{title:title,description:description},items.map(function(value,index){var key=getKey(uri,index);return _react.default.createElement(_shinkansenCogs.RadioCog,{key:key,title:String(value),value:String(index),id:key,name:name,onChange:onChange,required:isRequired,checked:selectedItems.includes(index)});}));}function renderToRadiosForAnyOf(_ref4,_ref5,_ref6,onChange){var _ref4$items=_ref4.items,items=_ref4$items===void 0?[]:_ref4$items,_ref4$selectedItems=_ref4.selectedItems,selectedItems=_ref4$selectedItems===void 0?[]:_ref4$selectedItems,uri=_ref4.uri;var title=_ref5.title,description=_ref5.description,_ref5$anyOf=_ref5.anyOf,id=_ref5$anyOf.id,_ref5$anyOf$name=_ref5$anyOf.name,name=_ref5$anyOf$name===void 0?id:_ref5$anyOf$name,_ref5$anyOf$isRequire=_ref5$anyOf.isRequired,isRequired=_ref5$anyOf$isRequire===void 0?false:_ref5$anyOf$isRequire;var components=_ref6.components,errors=_ref6.errors;log('renderToRadiosForAnyOf');return _react.default.createElement(_shinkansenSprockets.FieldsetSprocket,{title:title,description:description},items.map(function(_ref7,index){var uri=_ref7.meta.uri,_ref7$elements=_ref7.elements,title=_ref7$elements.title,description=_ref7$elements.description,id=_ref7$elements.field.id;return _react.default.createElement(_shinkansenCogs.RadioCog,{key:uri,title:title,description:description,value:String(index),id:id,name:name,onChange:onChange,required:isRequired,checked:selectedItems.includes(index)});}));}function renderToRadiosForOneOf(_ref8,_ref9,_ref10,onChange){var _ref8$items=_ref8.items,items=_ref8$items===void 0?[]:_ref8$items,_ref8$selectedItems=_ref8.selectedItems,selectedItems=_ref8$selectedItems===void 0?[]:_ref8$selectedItems,uri=_ref8.uri;var title=_ref9.title,description=_ref9.description,_ref9$oneOf=_ref9.oneOf,id=_ref9$oneOf.id,_ref9$oneOf$name=_ref9$oneOf.name,name=_ref9$oneOf$name===void 0?id:_ref9$oneOf$name,_ref9$oneOf$isRequire=_ref9$oneOf.isRequired,isRequired=_ref9$oneOf$isRequire===void 0?false:_ref9$oneOf$isRequire;var components=_ref10.components,errors=_ref10.errors;log('renderToRadiosForOneOf');return _react.default.createElement(_shinkansenSprockets.FieldsetSprocket,{title:title,description:description},items.map(function(_ref11,index){var uri=_ref11.meta.uri,_ref11$elements=_ref11.elements,title=_ref11$elements.title,description=_ref11$elements.description,id=_ref11$elements.field.id;return _react.default.createElement(_shinkansenCogs.RadioCog,{key:uri,title:title,description:description,value:String(index),id:id,name:name,onChange:onChange,required:isRequired,checked:selectedItems.includes(index)});}));}function renderToSelectForEnum(_ref12,_ref13,_ref14,onChange){var _ref12$items=_ref12.items,items=_ref12$items===void 0?[]:_ref12$items,_ref12$selectedItems=_ref12.selectedItems,selectedItems=_ref12$selectedItems===void 0?[]:_ref12$selectedItems,uri=_ref12.uri;var title=_ref13.title,description=_ref13.description,_ref13$enum=_ref13.enum,id=_ref13$enum.id,_ref13$enum$name=_ref13$enum.name,name=_ref13$enum$name===void 0?id:_ref13$enum$name,_ref13$enum$isRequire=_ref13$enum.isRequired,isRequired=_ref13$enum$isRequire===void 0?false:_ref13$enum$isRequire;var components=_ref14.components,errors=_ref14.errors;log('renderToSelectForEnum');return _react.default.createElement(_shinkansenCogs.SelectCog,{title:title,description:description,name:name,onChange:onChange,required:isRequired},items.map(function(value,index){return _react.default.createElement("option",{key:getKey(uri,index),value:String(index),selected:selectedItems.includes(index)},value);}));}function renderToSelectForAnyOf(_ref15,_ref16,_ref17,onChange){var _ref15$items=_ref15.items,items=_ref15$items===void 0?[]:_ref15$items,_ref15$selectedItems=_ref15.selectedItems,selectedItems=_ref15$selectedItems===void 0?[]:_ref15$selectedItems,uri=_ref15.uri;var title=_ref16.title,description=_ref16.description,_ref16$anyOf=_ref16.anyOf,id=_ref16$anyOf.id,_ref16$anyOf$name=_ref16$anyOf.name,name=_ref16$anyOf$name===void 0?id:_ref16$anyOf$name,_ref16$anyOf$isRequir=_ref16$anyOf.isRequired,isRequired=_ref16$anyOf$isRequir===void 0?false:_ref16$anyOf$isRequir;var components=_ref17.components,errors=_ref17.errors;log('renderToSelectForAnyOf');return _react.default.createElement(_shinkansenCogs.SelectCog,{title:title,description:description,name:name,onChange:onChange,required:isRequired},items.map(function(_ref18,index){var uri=_ref18.meta.uri,title=_ref18.elements.title;return _react.default.createElement("option",{key:uri,value:String(index),selected:selectedItems.includes(index)},title);}));}function renderToSelectForOneOf(_ref19,_ref20,_ref21,onChange){var _ref19$items=_ref19.items,items=_ref19$items===void 0?[]:_ref19$items,_ref19$selectedItems=_ref19.selectedItems,selectedItems=_ref19$selectedItems===void 0?[]:_ref19$selectedItems,uri=_ref19.uri;var title=_ref20.title,description=_ref20.description,_ref20$oneOf=_ref20.oneOf,id=_ref20$oneOf.id,_ref20$oneOf$name=_ref20$oneOf.name,name=_ref20$oneOf$name===void 0?id:_ref20$oneOf$name,_ref20$oneOf$isRequir=_ref20$oneOf.isRequired,isRequired=_ref20$oneOf$isRequir===void 0?false:_ref20$oneOf$isRequir;var components=_ref21.components,errors=_ref21.errors;log('renderToSelectForOneOf');return _react.default.createElement(_shinkansenCogs.SelectCog,{title:title,description:description,name:name,onChange:onChange,required:isRequired},items.map(function(_ref22,index){var uri=_ref22.meta.uri,title=_ref22.elements.title;return _react.default.createElement("option",{key:uri,value:String(index),selected:selectedItems.includes(index)},title);}));}function renderToField(meta,elements,params,onChange){log('renderToField');var title=elements.title,description=elements.description,_elements$field=elements.field;_elements$field=_elements$field===void 0?{}:_elements$field;var id=_elements$field.id,_elements$field$isReq=_elements$field.isRequired,isRequired=_elements$field$isReq===void 0?false:_elements$field$isReq,field=_objectWithoutProperties(_elements$field,["id","isRequired"]);log({value:getValue(field),defaultValue:getDefaultValue(field),onChange:onChange});return _react.default.createElement(_shinkansenCogs.TextCog,{title:title,description:description,name:id,value:getValue(field),required:isRequired,onChange:onChange});}function GroupComponent(_ref23){var component=_ref23.component,meta=_ref23.meta,elements=_ref23.elements,params=_ref23.params,onChange=_ref23.onChange;}function FieldComponent(_ref24){var component=_ref24.component,meta=_ref24.meta,elements=_ref24.elements,params=_ref24.params,onChange=_ref24.onChange;}function Group(_ref25){var meta=_ref25.meta,elements=_ref25.elements,params=_ref25.params,onChange=_ref25.onChange;log('Group');var title=elements.title,_elements$fields=elements.fields,fields=_elements$fields===void 0?[]:_elements$fields;return _react.default.createElement(_shinkansenSprockets.FieldsetSprocket,{title:title},fields.map(function(pinion){var _pinion$meta=pinion.meta;_pinion$meta=_pinion$meta===void 0?{}:_pinion$meta;var uri=_pinion$meta.uri;return _react.default.createElement(Pinion,{key:uri,pinion:pinion,params:params,onChange:onChange});}));}Group.propTypes={meta:_propTypes.default.shape().isRequired,elements:_propTypes.default.shape().isRequired,params:_propTypes.default.shape().isRequired,onChange:_propTypes.default.func};Group.defaultProps={onChange:onChange};function Field(_ref26){var meta=_ref26.meta,elements=_ref26.elements,params=_ref26.params,onChange=_ref26.onChange;log('Field');if((0,_hasEnum.default)(elements)){log('Field (`enum`)');return renderToRadiosForEnum(meta,elements,params,onChange);}else{if((0,_hasAnyOf.default)(elements)){log('Field (`anyOf`)');return renderToRadiosForAnyOf(meta,elements,params,onChange);}else{if((0,_hasOneOf.default)(elements)){log('Field (`oneOf`)');return renderToRadiosForOneOf(meta,elements,params,onChange);}else{log('Field (`field`)');return renderToField(meta,elements,params,onChange);}}}}Field.propTypes={meta:_propTypes.default.shape().isRequired,elements:_propTypes.default.shape().isRequired,params:_propTypes.default.shape().isRequired,onChange:_propTypes.default.func};Field.defaultProps={onChange:onChange};function renderGroup(_ref27,params,onChange){var meta=_ref27.meta,elements=_ref27.elements;log('renderGroup');if((0,_hasComponent.default)(meta)){var component=(0,_getComponent.default)(meta);return _react.default.createElement(GroupComponent,{component:component,meta:meta,elements:elements,params:params,onChange:onChange});}return _react.default.createElement(Group,{meta:meta,elements:elements,params:params,onChange:onChange});}function renderField(_ref28,params,onChange){var meta=_ref28.meta,elements=_ref28.elements;log('renderField');if((0,_hasComponent.default)(meta)){var component=(0,_getComponent.default)(meta);return _react.default.createElement(FieldComponent,{component:component,meta:meta,elements:elements,params:params,onChange:onChange});}return _react.default.createElement(Field,{meta:meta,elements:elements,params:params,onChange:onChange});}function Pinion(_ref29){var pinion=_ref29.pinion,params=_ref29.params,onChange=_ref29.onChange;log('Pinion');var _pinion$meta2=pinion.meta;_pinion$meta2=_pinion$meta2===void 0?{}:_pinion$meta2;var type=_pinion$meta2.type;return type==='object'||type==='array'?renderGroup(pinion,params,onChange):renderField(pinion,params,onChange);}Pinion.propTypes={pinion:_propTypes.default.shape({meta:_propTypes.default.shape().isRequired,elements:_propTypes.default.shape().isRequired}).isRequired,params:_propTypes.default.shape({components:_propTypes.default.shape(),errors:_propTypes.default.array}),onChange:_propTypes.default.func};Pinion.defaultProps={params:{},onChange:onChange};